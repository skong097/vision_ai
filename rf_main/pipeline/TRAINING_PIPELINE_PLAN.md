# Home Safe Solution - ìë™í™” í•™ìŠµ íŒŒì´í”„ë¼ì¸ ì„¤ê³„ì„œ

## 2026-02-05 (ìˆ˜)

---

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GUI Training Page (PyQt5)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Data      â”‚ â”‚ Preproc  â”‚ â”‚ Training  â”‚ â”‚ Results Viewer   â”‚  â”‚
â”‚  â”‚ Source    â”‚ â”‚ Config   â”‚ â”‚ Config    â”‚ â”‚ (ë¹„êµ ë¦¬í¬íŠ¸)     â”‚  â”‚
â”‚  â”‚ Manager   â”‚ â”‚ Panel    â”‚ â”‚ & Monitor â”‚ â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚             â”‚                 â”‚
        â–¼            â–¼             â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TrainingPipelineOrchestrator (Core)                 â”‚
â”‚                                                                 â”‚
â”‚  Stage 1        Stage 2          Stage 3          Stage 4       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Data     â”‚â”€â”€â–¶â”‚ Preproc  â”‚â”€â”€â–¶â”‚ Training â”‚â”€â”€â–¶â”‚ Auto      â”‚   â”‚
â”‚  â”‚ Ingest   â”‚   â”‚ Engine   â”‚    â”‚ Engine   â”‚    â”‚ Compare   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  - YouTube DL   - YOLO Pose     - RF (sklearn)   - compare_    â”‚
â”‚  - URL fetch    - Feature Ext   - ST-GCN (torch)   models.py   â”‚
â”‚  - Local files  - Sequence Gen  - Hyperparam      - Report     â”‚
â”‚  - Label mgmt   - Train/Val/    - Early stopping    generation â”‚
â”‚                    Test split   - Checkpoint mgmt              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. íŒŒì¼ êµ¬ì¡°

```
/home/gjkong/dev_ws/yolo/myproj/
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ main.py                          # ê¸°ì¡´ GUI ë©”ì¸
â”‚   â”œâ”€â”€ monitoring_page.py               # ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ í˜ì´ì§€
â”‚   â”œâ”€â”€ training_page.py                 # â­ ì‹ ê·œ - í•™ìŠµ íŒŒì´í”„ë¼ì¸ GUI
â”‚   â”œâ”€â”€ training_data_panel.py           # â­ ì‹ ê·œ - ë°ì´í„° ì†ŒìŠ¤ íŒ¨ë„
â”‚   â”œâ”€â”€ training_config_panel.py         # â­ ì‹ ê·œ - í•™ìŠµ ì„¤ì • íŒ¨ë„
â”‚   â”œâ”€â”€ training_progress_widget.py      # â­ ì‹ ê·œ - í•™ìŠµ ì§„í–‰ ëª¨ë‹ˆí„°
â”‚   â””â”€â”€ training_results_viewer.py       # â­ ì‹ ê·œ - ê²°ê³¼ ë¦¬í¬íŠ¸ ë·°ì–´
â”‚
â”œâ”€â”€ pipeline/                            # â­ ì‹ ê·œ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ orchestrator.py                  # íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°
â”‚   â”œâ”€â”€ data_ingest.py                   # Stage 1: ë°ì´í„° ìˆ˜ì§‘
â”‚   â”œâ”€â”€ preprocessor.py                  # Stage 2: ì „ì²˜ë¦¬
â”‚   â”œâ”€â”€ trainer.py                       # Stage 3: í•™ìŠµ ì—”ì§„
â”‚   â”œâ”€â”€ auto_compare.py                  # Stage 4: ìë™ ë¹„êµ
â”‚   â””â”€â”€ config.py                        # íŒŒì´í”„ë¼ì¸ ì„¤ì • ê´€ë¦¬
â”‚
â”œâ”€â”€ scripts/admin/
â”‚   â””â”€â”€ Model_Compare_Report/            # ê¸°ì¡´ ë¹„êµ ë¦¬í¬íŠ¸
â”‚
â””â”€â”€ dataset/                             # ë°ì´í„°ì…‹ ë””ë ‰í† ë¦¬
    â”œâ”€â”€ raw_videos/                      # â­ ì›ë³¸ ë¹„ë””ì˜¤ ì €ì¥
    â”‚   â”œâ”€â”€ fall/                        # ë‚™ìƒ ë¹„ë””ì˜¤
    â”‚   â””â”€â”€ normal/                      # ì •ìƒ ë¹„ë””ì˜¤
    â”œâ”€â”€ binary/                          # RF í•™ìŠµ ë°ì´í„°
    â”‚   â”œâ”€â”€ train.csv
    â”‚   â”œâ”€â”€ val.csv
    â”‚   â””â”€â”€ test.csv
    â””â”€â”€ sequences/                       # ST-GCN í•™ìŠµ ë°ì´í„°
        â”œâ”€â”€ train_data.npy
        â”œâ”€â”€ train_labels.npy
        â”œâ”€â”€ val_data.npy
        â”œâ”€â”€ val_labels.npy
        â”œâ”€â”€ test_data.npy
        â””â”€â”€ test_labels.npy
```

---

## 3. Stage 1 - ë°ì´í„° ìˆ˜ì§‘ (data_ingest.py)

### 3.1 ì§€ì› ì†ŒìŠ¤ íƒ€ì…

| ì†ŒìŠ¤ | ì…ë ¥ í˜•íƒœ | ì²˜ë¦¬ ë°©ë²• |
|------|----------|----------|
| YouTube | URL (ë‹¨ì¼/ì¬ìƒëª©ë¡) | `yt-dlp` â†’ mp4 |
| ì¸í„°ë„· ë™ì˜ìƒ | HTTP/HTTPS URL | `requests` + `ffprobe` ê²€ì¦ |
| ë¡œì»¬ íŒŒì¼ | íŒŒì¼ ê²½ë¡œ / í´ë” ê²½ë¡œ | ì§ì ‘ ë³µì‚¬ ë˜ëŠ” ì‹¬ë³¼ë¦­ ë§í¬ |
| ë°ì´í„°ì…‹ í´ë” | ê²½ë¡œ (fall/, normal/ êµ¬ì¡°) | êµ¬ì¡° ê²€ì¦ í›„ ë“±ë¡ |

### 3.2 ì§€ì› ë™ì˜ìƒ í¬ë§·

`*.mp4`, `*.avi`, `*.mov`, `*.mkv`, `*.webm`, `*.flv`, `*.wmv`, `*.m4v`

### 3.3 ë¼ë²¨ë§ ì „ëµ

```python
class LabelStrategy:
    FOLDER_BASED = "folder"      # fall/ , normal/ í´ë” êµ¬ì¡°
    FILENAME_BASED = "filename"  # fall-01.mp4, normal-03.mp4
    CSV_MANIFEST = "csv"         # manifest.csv (íŒŒì¼ëª…, ë¼ë²¨)
    MANUAL = "manual"            # GUIì—ì„œ ì§ì ‘ ë¼ë²¨ ì§€ì •
```

### 3.4 ë°ì´í„° ìˆ˜ì§‘ ì„¤ì • (GUI)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¥ ë°ì´í„° ì†ŒìŠ¤ ê´€ë¦¬                                  â”‚
â”‚                                                      â”‚
â”‚  ì†ŒìŠ¤ íƒ€ì…: [YouTube â–¼]                               â”‚
â”‚                                                      â”‚
â”‚  URL/ê²½ë¡œ: [https://youtube.com/watch?v=...    ] [+] â”‚
â”‚                                                      â”‚
â”‚  ë¼ë²¨:  â—‹ Fall  â—‹ Normal  â—‹ ìë™ (í´ë”/íŒŒì¼ëª… ê¸°ë°˜)   â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ # â”‚ ì†ŒìŠ¤          â”‚ ë¼ë²¨   â”‚ ìƒíƒœ    â”‚ ì‚­ì œ  â”‚    â”‚
â”‚  â”‚ 1 â”‚ fall-01.mp4   â”‚ Fall   â”‚ âœ… ì™„ë£Œ â”‚  ğŸ—‘  â”‚    â”‚
â”‚  â”‚ 2 â”‚ youtube/abc.. â”‚ Normal â”‚ â³ ëŒ€ê¸° â”‚  ğŸ—‘  â”‚    â”‚
â”‚  â”‚ 3 â”‚ normal-02.avi â”‚ Normal â”‚ âœ… ì™„ë£Œ â”‚  ğŸ—‘  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                      â”‚
â”‚  ì´ ë¹„ë””ì˜¤: 25ê°œ (Fall: 12, Normal: 13)              â”‚
â”‚  [ğŸ“‚ í´ë” ì¼ê´„ ì¶”ê°€]  [ğŸ“‹ CSV ê°€ì ¸ì˜¤ê¸°]  [â–¶ ë‹¤ìš´ë¡œë“œ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Stage 2 - ì „ì²˜ë¦¬ (preprocessor.py)

### 4.1 ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

```
ì›ë³¸ ë¹„ë””ì˜¤ (mp4/avi/...)
    â”‚
    â–¼
[1] FFmpeg ì •ê·œí™”
    - í•´ìƒë„ í†µì¼ (640x480 ê¸°ë³¸)
    - FPS í†µì¼ (30fps ê¸°ë³¸)
    - ì½”ë± í†µì¼ (H.264)
    â”‚
    â–¼
[2] YOLO Pose Estimation
    - YOLOv8-pose ì¶”ë¡ 
    - 17ê°œ í‚¤í¬ì¸íŠ¸ ì¶”ì¶œ (COCO format)
    - í”„ë ˆì„ë³„ í‚¤í¬ì¸íŠ¸ ì‹œí€€ìŠ¤ ì €ì¥
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                      â–¼
[3a] RF íŠ¹ì§• ì¶”ì¶œ          [3b] ST-GCN ì‹œí€€ìŠ¤ ìƒì„±
    - ê´€ì ˆ ê°ë„ ê³„ì‚°        - 60í”„ë ˆì„ ìŠ¬ë¼ì´ë”© ìœˆë„ìš°
    - ê±°ë¦¬/ë¹„ìœ¨ íŠ¹ì§•         - (3, 60, 17, 1) í…ì„œ
    - ì†ë„/ê°€ì†ë„ íŠ¹ì§•       - ì •ê·œí™” (center, scale)
    - feature_columns.txt   - overlap stride ì„¤ì •
    â”‚                      â”‚
    â–¼                      â–¼
[4a] RF Dataset            [4b] ST-GCN Dataset
    - train.csv             - train_data.npy
    - val.csv               - val_data.npy
    - test.csv              - test_data.npy
```

### 4.2 ì „ì²˜ë¦¬ ì„¤ì •

```python
@dataclass
class PreprocessConfig:
    # ë¹„ë””ì˜¤ ì •ê·œí™”
    target_resolution: tuple = (640, 480)
    target_fps: int = 30
    
    # YOLO Pose
    yolo_model: str = "yolov8m-pose.pt"
    confidence_threshold: float = 0.5
    
    # ST-GCN ì‹œí€€ìŠ¤
    sequence_length: int = 60          # í”„ë ˆì„ ìˆ˜
    sequence_stride: int = 30          # ìŠ¬ë¼ì´ë”© ìœˆë„ìš° stride
    normalize_method: str = "center"   # center / minmax / none
    
    # ë°ì´í„° ë¶„í• 
    train_ratio: float = 0.7
    val_ratio: float = 0.15
    test_ratio: float = 0.15
    random_seed: int = 42
    stratify: bool = True              # ë¼ë²¨ ë¹„ìœ¨ ìœ ì§€
```

---

## 5. Stage 3 - í•™ìŠµ ì—”ì§„ (trainer.py)

### 5.1 RF í•™ìŠµ ì„¤ì •

```python
@dataclass
class RFTrainConfig:
    n_estimators: list = field(default_factory=lambda: [50, 100, 200, 300])
    max_depth: list = field(default_factory=lambda: [None, 10, 20, 30])
    min_samples_split: list = field(default_factory=lambda: [2, 5, 10])
    min_samples_leaf: list = field(default_factory=lambda: [1, 2, 4])
    
    # íŠœë‹ ë°©ë²•
    tuning_method: str = "grid"        # grid / random / bayesian
    cv_folds: int = 5
    scoring: str = "f1"                # accuracy / f1 / recall
```

### 5.2 ST-GCN í•™ìŠµ ì„¤ì •

```python
@dataclass
class STGCNTrainConfig:
    # ê¸°ë³¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°
    epochs: int = 50
    batch_size: int = 16
    
    # Learning Rate
    backbone_lr: float = 1e-5
    head_lr: float = 1e-3
    weight_decay: float = 1e-4
    
    # ìŠ¤ì¼€ì¤„ëŸ¬
    scheduler: str = "cosine"          # cosine / step / plateau
    
    # Early Stopping
    early_stopping: bool = True
    patience: int = 10
    min_delta: float = 0.001
    
    # Fine-tuning ì˜µì…˜
    use_pretrained: bool = True
    freeze_backbone_epochs: int = 5    # ì´ˆê¸° N ì—í¬í¬ backbone ë™ê²°
    
    # íŠœë‹ ë²”ìœ„ (Optuna ì‚¬ìš© ì‹œ)
    tuning_enabled: bool = False
    n_trials: int = 20
    tuning_params: dict = field(default_factory=lambda: {
        "backbone_lr": (1e-6, 1e-4),
        "head_lr": (1e-4, 1e-2),
        "batch_size": [8, 16, 32],
        "weight_decay": (1e-5, 1e-3),
    })
```

### 5.3 í•™ìŠµ GUI ëª¨ë‹ˆí„°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ í•™ìŠµ ì§„í–‰ ìƒí™©                                    â”‚
â”‚                                                      â”‚
â”‚  í˜„ì¬ ë‹¨ê³„: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] ST-GCN í•™ìŠµ (3/4)   â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€ RF í•™ìŠµ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ìƒíƒœ: âœ… ì™„ë£Œ  |  Best F1: 0.9189               â”‚ â”‚
â”‚  â”‚ ìµœì  íŒŒë¼ë¯¸í„°: n_estimators=100, max_depth=20   â”‚ â”‚
â”‚  â”‚ ì†Œìš” ì‹œê°„: 45ì´ˆ                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€ ST-GCN Fine-tuning â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Epoch: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘] 17/50                      â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚   Train Loss  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  0.2560      â”‚ â”‚
â”‚  â”‚   Train Acc   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  90.23%      â”‚ â”‚
â”‚  â”‚   Val Loss    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  0.2184      â”‚ â”‚
â”‚  â”‚   Val Acc     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  91.89% â­   â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚   Best Val Acc: 91.89% (Epoch 17)              â”‚ â”‚
â”‚  â”‚   Early Stop: 0/10                              â”‚ â”‚
â”‚  â”‚                                                  â”‚ â”‚
â”‚  â”‚   [ì‹¤ì‹œê°„ Loss/Acc ê·¸ë˜í”„]                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                      â”‚
â”‚  [â¸ ì¼ì‹œì •ì§€]  [â¹ ì¤‘ë‹¨]  [ğŸ“Š ì¤‘ê°„ ê²°ê³¼ ë³´ê¸°]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Stage 4 - ìë™ ë¹„êµ (auto_compare.py)

### 6.1 ìë™ íŠ¸ë¦¬ê±° íë¦„

```
í•™ìŠµ ì™„ë£Œ (RF + ST-GCN)
    â”‚
    â–¼
ìƒˆ ëª¨ë¸ ì²´í¬í¬ì¸íŠ¸ â†’ ì„ì‹œ ê²½ë¡œì— ì €ì¥
    â”‚
    â–¼
compare_models.py ìë™ ì‹¤í–‰
    - ê¸°ì¡´ ëª¨ë¸ vs ìƒˆ ëª¨ë¸ ë¹„êµ
    - ë¦¬í¬íŠ¸ ìë™ ìƒì„±
    â”‚
    â–¼
ì„±ëŠ¥ ë¹„êµ ê²°ê³¼ íŒì •
    â”œâ”€â”€ ìƒˆ ëª¨ë¸ì´ ë” ì¢‹ìœ¼ë©´ â†’ ëª¨ë¸ êµì²´ ì œì•ˆ
    â””â”€â”€ ê¸°ì¡´ ëª¨ë¸ì´ ë” ì¢‹ìœ¼ë©´ â†’ ìœ ì§€ ê¶Œì¥
    â”‚
    â–¼
GUIì— ê²°ê³¼ í‘œì‹œ + ì‚¬ìš©ì ìŠ¹ì¸
    â”œâ”€â”€ [âœ… ìƒˆ ëª¨ë¸ ì ìš©] â†’ ëª¨ë¸ íŒŒì¼ êµì²´
    â””â”€â”€ [âŒ ê¸°ì¡´ ìœ ì§€]    â†’ ìƒˆ ëª¨ë¸ ì•„ì¹´ì´ë¸Œ
```

### 6.2 ë¹„êµ ë¦¬í¬íŠ¸ ìë™ ìƒì„± ê²½ë¡œ

```
~/dev_ws/yolo/myproj/scripts/admin/Model_Compare_Report/
â””â”€â”€ 20260205_HHMMSS/
    â”œâ”€â”€ MODEL_COMPARISON_REPORT.md
    â”œâ”€â”€ dashboard_comparison.png
    â”œâ”€â”€ confusion_matrices.png
    â”œâ”€â”€ roc_curves.png
    â”œâ”€â”€ inference_time.png
    â””â”€â”€ model_size.png
```

---

## 7. Orchestrator í•µì‹¬ ì¸í„°í˜ì´ìŠ¤

```python
class TrainingPipelineOrchestrator:
    """ì „ì²´ íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°"""
    
    # ì‹œê·¸ë„ (GUI ì—°ë™)
    stage_changed = Signal(str, int)        # (stage_name, progress%)
    log_message = Signal(str)               # ë¡œê·¸ ë©”ì‹œì§€
    training_metric = Signal(dict)          # ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­
    pipeline_finished = Signal(dict)        # ìµœì¢… ê²°ê³¼
    pipeline_error = Signal(str)            # ì—ëŸ¬ ë°œìƒ
    
    def run_full_pipeline(self, config: PipelineConfig):
        """ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (ë¹„ë™ê¸°)"""
        # Stage 1: ë°ì´í„° ìˆ˜ì§‘
        # Stage 2: ì „ì²˜ë¦¬
        # Stage 3: í•™ìŠµ
        # Stage 4: ìë™ ë¹„êµ
    
    def run_from_stage(self, stage: int, config: PipelineConfig):
        """íŠ¹ì • ìŠ¤í…Œì´ì§€ë¶€í„° ì‹¤í–‰ (ì´ì „ ê²°ê³¼ ì¬ì‚¬ìš©)"""
    
    def pause(self): ...
    def resume(self): ...
    def cancel(self): ...
```

---

## 8. GUI í†µí•© - training_page.py

### 8.1 ì „ì²´ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ  Home Safe Solution - Training Pipeline                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚                                                       â”‚
â”‚  ğŸ“¥     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  Data   â”‚  â”‚  [í˜„ì¬ í™œì„± íŒ¨ë„ ì˜ì—­]                            â”‚  â”‚
â”‚  Source â”‚  â”‚                                                   â”‚  â”‚
â”‚         â”‚  â”‚  ë°ì´í„° ì†ŒìŠ¤ / ì „ì²˜ë¦¬ ì„¤ì • / í•™ìŠµ ì„¤ì • /          â”‚  â”‚
â”‚  âš™ï¸     â”‚  â”‚  í•™ìŠµ ëª¨ë‹ˆí„° / ê²°ê³¼ ë·°ì–´                          â”‚  â”‚
â”‚  Preprocâ”‚  â”‚                                                   â”‚  â”‚
â”‚         â”‚  â”‚                                                   â”‚  â”‚
â”‚  ğŸ¯     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Train  â”‚                                                       â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  ğŸ“Š     â”‚  â”‚  ì§„í–‰ ìƒíƒœ ë°” + ë¡œê·¸ ì¶œë ¥                         â”‚  â”‚
â”‚  Resultsâ”‚  â”‚  Stage: [â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡] ì „ì²˜ë¦¬ (50%)                â”‚  â”‚
â”‚         â”‚  â”‚  > YOLO í¬ì¦ˆ ì¶”ì • ì¤‘... (23/50 ë¹„ë””ì˜¤)            â”‚  â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â–¶ ì „ì²´ ì‹¤í–‰]  [â¸ ì¼ì‹œì •ì§€]  [â¹ ì¤‘ë‹¨]  [ğŸ“‚ ë¦¬í¬íŠ¸ í´ë” ì—´ê¸°]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 GUI ì—°ë™ ì‹œê·¸ë„ íë¦„

```
Orchestrator (Worker Thread)          GUI (Main Thread)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
stage_changed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ì§„í–‰ë°” + ë‹¨ê³„ í‘œì‹œ ì—…ë°ì´íŠ¸
log_message â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ë¡œê·¸ í…ìŠ¤íŠ¸ ì˜ì—­ ì¶”ê°€
training_metric â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ì‹¤ì‹œê°„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
pipeline_finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ê²°ê³¼ ë·°ì–´ í™œì„±í™”
pipeline_error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ì—ëŸ¬ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
```

---

## 9. ì˜ì¡´ì„± íŒ¨í‚¤ì§€

```bash
# ë°ì´í„° ìˆ˜ì§‘
pip install yt-dlp requests

# ì „ì²˜ë¦¬
pip install ultralytics opencv-python ffmpeg-python

# í•™ìŠµ
pip install scikit-learn torch numpy pandas

# í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ (ì„ íƒ)
pip install optuna

# ì‹œê°í™”
pip install matplotlib

# GUI
pip install PyQt5
```

---

## 10. êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase A: í•µì‹¬ íŒŒì´í”„ë¼ì¸ (pipeline/)
1. `config.py` - ì„¤ì • ë°ì´í„°í´ë˜ìŠ¤ ì •ì˜
2. `data_ingest.py` - ë°ì´í„° ìˆ˜ì§‘ (YouTube + URL + ë¡œì»¬)
3. `preprocessor.py` - ì „ì²˜ë¦¬ (YOLO â†’ Feature/Sequence)
4. `trainer.py` - í•™ìŠµ ì—”ì§„ (RF + ST-GCN)
5. `auto_compare.py` - ìë™ ë¹„êµ íŠ¸ë¦¬ê±°
6. `orchestrator.py` - ì „ì²´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜

### Phase B: GUI í†µí•© (gui/)
1. `training_page.py` - ë©”ì¸ í•™ìŠµ í˜ì´ì§€
2. `training_data_panel.py` - ë°ì´í„° ì†ŒìŠ¤ íŒ¨ë„
3. `training_config_panel.py` - í•™ìŠµ ì„¤ì • íŒ¨ë„
4. `training_progress_widget.py` - ì§„í–‰ ëª¨ë‹ˆí„°
5. `training_results_viewer.py` - ê²°ê³¼ ë·°ì–´

### Phase C: ê³ ê¸‰ ê¸°ëŠ¥
1. Optuna í•˜ì´í¼íŒŒë¼ë¯¸í„° ìë™ íŠœë‹
2. ë°ì´í„° ì¦ê°• (Data Augmentation)
3. ëª¨ë¸ ì•™ìƒë¸” í•™ìŠµ
4. í•™ìŠµ ì´ë ¥ ê´€ë¦¬ ë° ë²„ì „ ë¹„êµ

---

## 11. ì»¤ë§¨ë“œ ë¼ì¸ ì‹¤í–‰ (GUI ì—†ì´)

```bash
# ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
python -m pipeline.orchestrator \
    --data-dir ./dataset/raw_videos/ \
    --label-strategy folder \
    --train-rf --train-stgcn \
    --auto-compare

# íŠ¹ì • ìŠ¤í…Œì´ì§€ë§Œ ì‹¤í–‰
python -m pipeline.orchestrator \
    --stage preprocess \
    --data-dir ./dataset/raw_videos/

# í•™ìŠµë§Œ ì‹¤í–‰ (ê¸°ì¡´ ë°ì´í„° ì‚¬ìš©)
python -m pipeline.orchestrator \
    --stage train \
    --train-stgcn \
    --epochs 100 \
    --auto-compare
```

---

**ì‘ì„±ì¼:** 2026-02-05
**ìƒíƒœ:** ì„¤ê³„ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸°
